"use strict";(()=>{var e={};e.id=1770,e.ids=[1770],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},63477:e=>{e.exports=require("querystring")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},34234:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>_,originalPathname:()=>f,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>q,staticGenerationBailout:()=>y});var s={};t.r(s),t.d(s,{GET:()=>GET}),t(78976);var i=t(10884),n=t(16132),o=t(40674),a=t(41045),u=t(56840),p=t(8192),c=t(28761),l=t(15310),d=t(43935);let x=(0,d.G)("/dashboard/billing");async function GET(e){try{let e=await (0,o.getServerSession)(p.L);if(!e?.user||!e?.user.email)return new Response(null,{status:403});let r=await (0,l.b)(e.user.id);if(r.isPro&&r.stripeCustomerId){let e=await c.A.billingPortal.sessions.create({customer:r.stripeCustomerId,return_url:x});return new Response(JSON.stringify({url:e.url}))}let t=await c.A.checkout.sessions.create({success_url:x,cancel_url:x,payment_method_types:["card"],mode:"subscription",billing_address_collection:"auto",customer_email:e.user.email,line_items:[{price:u.H.stripePriceId,quantity:1}],metadata:{userId:e.user.id}});return new Response(JSON.stringify({url:t.url}))}catch(e){if(e instanceof a.jm)return new Response(JSON.stringify(e.issues),{status:422});return new Response(null,{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/users/stripe/route",pathname:"/api/users/stripe",filename:"route",bundlePath:"app/api/users/stripe/route"},resolvedPagePath:"/Users/samhenry/patriot-heavy-ops/patriot-heavy-ops/app/api/users/stripe/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:q,serverHooks:g,headerHooks:_,staticGenerationBailout:y}=m,f="/api/users/stripe/route"},22601:(e,r,t)=>{t.d(r,{J:()=>s});let s={name:"Taxonomy",description:"An open source application built using the new router, server components and everything new in Next.js 13.",url:"https://tx.shadcn.com",ogImage:"https://tx.shadcn.com/og.jpg",links:{twitter:"https://twitter.com/shadcn",github:"https://github.com/shadcn/taxonomy"}}},28761:(e,r,t)=>{t.d(r,{A:()=>n});var s=t(80420),i=t(74658);let n=new s.Z(i.O.STRIPE_API_KEY||"",{apiVersion:"2022-11-15",typescript:!0})},43935:(e,r,t)=>{t.d(r,{G:()=>absoluteUrl,cn:()=>cn,p:()=>formatDate});var s=t(92822),i=t(30882),n=t(74658);function cn(...e){return(0,i.m)((0,s.clsx)(e))}function formatDate(e){let r=new Date(e);return r.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}function absoluteUrl(e){return`${n.O.NEXT_PUBLIC_APP_URL}${e}`}}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[6889,874,4596,6914,4933,420,4658,8192,5310],()=>__webpack_exec__(34234));module.exports=t})();