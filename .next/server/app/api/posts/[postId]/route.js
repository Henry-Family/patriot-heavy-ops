"use strict";(()=>{var e={};e.id=1924,e.ids=[1924],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},63477:e=>{e.exports=require("querystring")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},4125:(e,t,s)=>{s.r(t),s.d(t,{headerHooks:()=>y,originalPathname:()=>g,requestAsyncStorage:()=>h,routeModule:()=>x,serverHooks:()=>q,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>w});var r={};s.r(r),s.d(r,{DELETE:()=>DELETE,PATCH:()=>PATCH}),s(78976);var o=s(10884),n=s(16132),i=s(94020),a=s(11729),p=s(41045),u=s(8192),c=s(69363);let l=a.Ry({title:a.Z_().min(3).max(128).optional(),content:a.Yj().optional()}),d=a.Ry({params:a.Ry({postId:a.Z_()})});async function DELETE(e,t){try{let{params:e}=d.parse(t);if(!await verifyCurrentUserHasAccessToPost(e.postId))return new Response(null,{status:403});return await c.db.post.delete({where:{id:e.postId}}),new Response(null,{status:204})}catch(e){if(e instanceof p.jm)return new Response(JSON.stringify(e.issues),{status:422});return new Response(null,{status:500})}}async function PATCH(e,t){try{let{params:s}=d.parse(t);if(!await verifyCurrentUserHasAccessToPost(s.postId))return new Response(null,{status:403});let r=await e.json(),o=l.parse(r);return await c.db.post.update({where:{id:s.postId},data:{title:o.title,content:o.content}}),new Response(null,{status:200})}catch(e){if(e instanceof p.jm)return new Response(JSON.stringify(e.issues),{status:422});return new Response(null,{status:500})}}async function verifyCurrentUserHasAccessToPost(e){let t=await (0,i.getServerSession)(u.L),s=await c.db.post.count({where:{id:e,authorId:t?.user.id}});return s>0}let x=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/posts/[postId]/route",pathname:"/api/posts/[postId]",filename:"route",bundlePath:"app/api/posts/[postId]/route"},resolvedPagePath:"/Users/samhenry/patriot-heavy-ops/patriot-heavy-ops/app/api/posts/[postId]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:q,headerHooks:y,staticGenerationBailout:w}=x,g="/api/posts/[postId]/route"},22601:(e,t,s)=>{s.d(t,{J:()=>r});let r={name:"Taxonomy",description:"An open source application built using the new router, server components and everything new in Next.js 13.",url:"https://tx.shadcn.com",ogImage:"https://tx.shadcn.com/og.jpg",links:{twitter:"https://twitter.com/shadcn",github:"https://github.com/shadcn/taxonomy"}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[6889,4596,6914,4933,4020,4658,8192],()=>__webpack_exec__(4125));module.exports=s})();